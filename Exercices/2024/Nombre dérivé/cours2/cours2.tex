\documentclass[14pt]{beamer}
\usepackage[french]{babel}

\usetheme{CambridgeUS}
\usecolortheme{rose}
\beamertemplatenavigationsymbolsempty


\usepackage{libertinus}
\usepackage{amsmath,amsfonts,amsthm,amssymb,mathtools}
\usepackage{array}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}


\usepackage{stackengine}
\newcommand\xrowht[2][0]{\addstackgap[.5\dimexpr#2\relax]{\vphantom{#1}}}


% corps
\usepackage{calrsfs}
\newcommand{\C}{\mathcal{C}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Rnn}{\mathbb{R}^{2n}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}

% domain
\newcommand{\D}{\mathbb{D}}

% theorems

\theoremstyle{plain}
\newtheorem{rappel}{Rappel}
\newtheorem{propriete}{Propriété}
\newtheorem{outil}{Outil}
\newtheorem{exemple}{Exemple}
\newtheorem*{sol}{Solution}
\theoremstyle{definition}
\newtheorem{ex}{Exercice}

%plots
\usepackage{pgfplots, subcaption}
\definecolor{myg}{RGB}{56, 140, 70}
\definecolor{myb}{RGB}{45, 111, 177}
\definecolor{myr}{RGB}{199, 68, 64}

%boxes
\usepackage[most]{tcolorbox}
\usepackage{multicol}

%icomma
\usepackage{icomma}


% tableaux var, signe
\usepackage{tkz-tab}

%https://osl.ugr.es/CTAN/macros/latex/contrib/tcolorbox/tcolorbox.pdf
\newtcolorbox{mybox}[3][]
{
  colframe = #2!25,
  colback  = #2!10,
  coltitle = #2!20!black,  
  halign title=flush center, 
  title    = {#3},
  #1,
}

% BOX A BOX B
\newcommand{\boxAB}[2]{
		\begin{mybox}{red}{A}
		\begin{center}
			#1
		\end{center}
		\end{mybox}
		\begin{mybox}{green}{B}
		\begin{center}
			#2
		\end{center}
		\end{mybox}
}


% date
\usepackage{advdate}
\AdvanceDate[3]

\begin{document}

\section{Fonctions affines}


\subsection{Rappels}

\begin{frame}

	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|}\hline
		$x$ & $-3$ & $-2$ & $-1$ & $0$ &  1 & 2 & 3 \\ \hline
		$f(x) = -2x+1$ & \only<2->{7} & \only<4->{5} & \only<6->{3} & \only<8->{1} & \only<10->{$-1$} & \only<12->{$-3$} & \only<14->{$-5$} \\ \hline
	\end{tabular}

	\begin{tikzpicture}[scale=1]
	\begin{axis}[
	xmin = -3, xmax=3, ymin=-5, ymax=7, 
	grid = both,  xlabel={$x$}, ylabel={$f(x) = -2x+1$},
	xtick = {-3, ..., 3},
	ytick = {-5, ..., 7},
	]
	
	\only<3->{
		\addplot[myr, thick, mark=*, mark size = 2] (-3,7);
	}
	\only<5->{
		\addplot[myr, thick, mark=*, mark size = 2] (-2,5);
	}
	\only<7->{
		\addplot[myr, thick, mark=*, mark size = 2] (-1,3);
	}
	\only<9->{
		\addplot[myr, thick, mark=*, mark size = 2] (0,1);
	}
	\only<11->{
		\addplot[myr, thick, mark=*, mark size = 2] (1,-1);
	}
	\only<13->{
		\addplot[myr, thick, mark=*, mark size = 2] (2,-3);
	}
	\only<15->{
		\addplot[myr, thick, mark=*, mark size = 2] (3,-5);
	}
	
	\only<16->{
		\addplot[domain=-3:3, samples=2, myr, thick] {-2*x+1} node[pos=.5, above=10pt] {$\C_f$};
	}
	
	\end{axis}
	\end{tikzpicture}

\end{frame}

\subsection{Expression algébrique}

\begin{frame}


	\begin{rappel}[fonctions affines]

	Une fonction $f$ est \emph{affine} si elle s'écrit
		\[ f(x) = \pause ax+b, \]
	où \pause $a$ est le  \textbf{coefficient directeur}. \pause
	
	La courbe représentative de $f$ est une \pause \textbf{droite de pente }$\mathbf{a}$.

	\end{rappel}
	
\end{frame}


\subsection{Coefficient directeur}

\begin{frame}

	\begin{propriete}[1]

	Soit $f$ une fonction affine et $a$ son coefficient directeur.
		\begin{enumerate}	
			\item si $a > 0$, alors $f$ est \pause \textbf{croissante}. \pause
			\item si $a < 0$, alors $f$ est \pause \textbf{décroissante}. \pause
			\item si $a = 0$, alors $f$ est \pause \textbf{constante}.
		\end{enumerate}
		
	\end{propriete}
	
\end{frame}

\subsection{Théorème du coefficient directeur}

\begin{frame}

	\begin{outil}[théorème du coefficient directeur]
	Soient $x, y\in\R$ deux nombres distincts, et $f$ une fonction affine de coefficient directeur $a$.
	Alors
	
\begin{multicols}{2}
		\[ a = \visible<2->{\dfrac{f(y)-f(x)}{y-x}} \]
		\vfill
		\,
		
	\begin{tikzpicture}[scale=.7]
	\begin{axis}[xmin = -2, xmax=2, ymin=-5, ymax=3, grid = none,  xlabel={$x$}, ylabel={$f(x)$}]
		\addplot[domain=-2:2, samples=2, myb, thick] {2*x-1};
		
		\addplot[black, thick, mark=*, mark size = 1] (-1,-3) node[right=5pt] {$A(x; f(x))$};
		\addplot[black, thick, mark=*, mark size = 1] (1,1) node[above left] {$B(y; f(y))$};
	\end{axis}
	\end{tikzpicture}
\end{multicols}

	\end{outil}
\end{frame}

\section{Nombre dérivé}

\subsection{Zooms successifs}

\begin{frame}

\begin{center}
\begin{tikzpicture}[scale=.8]
\begin{axis}[xmin = -.75, xmax=-.25, ymin=-1, ymax=0, grid = none,  xlabel={$x$}, ylabel={$f(x)$}]
	\addplot[domain=-1:0, samples=500, myb, thick] {.5*(x+2)*(x+1)*(x-1)};
	
	\addplot[black, thick, mark=*, mark size = 1] (-.5,-.5625) node[right=5pt] {$A(x; f(x))$};
	\only<4->{
	\addplot[black, thick, mark=*, mark size = 1] (-.6,-.448) ;
	\addplot[black] (-.5,-.388) node{$B(x-h; f(x-h))$};
	}
	\only<1-3>{
	\addplot[black, thick, mark=*, mark size = 1] (-.4,-.672);
	\addplot[black] (-.4,-.75) node{$C(x+h; f(x+h))$};
	}
\end{axis}
\end{tikzpicture}
\end{center}

\only<1-3>{
La pente de la droite $(AC)$ est
	\[ a_h = \pause \dfrac{f(x+h)-f(x)}{(x+h)-x} \pause = \dfrac{f(x+h)-f(x)}{h}. \]
}
\only<4->{
\pause\pause\pause
La pente de la droite $(AB)$ est
	\[ a_h = \pause \dfrac{f(x)-f(x-h)}{x-(x-h)} \pause = \dfrac{f(x)-f(x-h)}{h} \pause = \dfrac{f(x-h)-f(x)}{-h}. \]
}

\end{frame}

\subsection{Exemple}

\begin{frame}
	\[ f(x) = \dfrac12(x^3 + 2x^2 - x - 2) \] 

	\[ a_h = \visible<2->{\dfrac{f(-0,5+h)-f(-0,5)}h} \]
	
	\begin{multicols}{2}
	\begin{tabular}{|c|c|}\hline
		$h$ & $a_h$ \\ \hline
		1 & \visible<3->{$-0,375$} \\ \hline
		0,1 & \visible<4->{$-1,095$} \\ \hline
		0,001 & \visible<5->{$-1,1247$}  \\ \hline
		-1 & \visible<6->{$-0,875$}  \\ \hline
		-0,1 & \visible<7->{$-1,145$} \\ \hline
		-0,001 & \visible<8->{$-1,1252$} \\ \hline
	\end{tabular}
	
	\hspace{-1.5cm}
	\begin{tikzpicture}[scale=.75]
	\begin{axis}[xmin = -3, xmax=2, ymin=-5, ymax=6, grid = none]
		\addplot[domain=-3:2, samples=500, myb, thick] {.5*(x+2)*(x+1)*(x-1)};
		
		% tangente
		\only<9>{
			\addplot[black, thick, mark=*, mark size = 1] (-.5,-0.5625);
		}
		\only<10->{
			\addplot[black, thick, mark=*, mark size = 1] (-.5,-0.5625)  node[pos=.2, above=20pt] {$f'(-0,5) = -1,125$};
		}
		\only<11->{
		\addplot[domain=-2:1, samples=2, myr, thick, <->] {-1.125*(x+.5)-.5625};
		}
	\end{axis}
	\end{tikzpicture}
	\end{multicols}
	
\end{frame}

\section{Fonction dérivée}

\subsection{Signe et variations}

\begin{frame}
	\begin{propriete}[2]
	Le signe de $f'(x)$ donne la variation de $f$ en $x$ et inversement :
		\begin{enumerate}
			\item si $f'(x) > 0$, alors \pause $f$ est croissante autour de $x$. \pause
			\item si $f$ est croissante autour de $x$, alors \pause $f'(x) > 0$. \pause
			\item si $f'(x) < 0$, alors \pause $f$ est décroissante autour de $x$. \pause
			\item si $f$ est décroissante autour de $x$, alors \pause $f'(x) < 0$.
	\end{enumerate}
\end{propriete}

\end{frame}

\subsection{Exemple}

\begin{frame}

	\begin{center}
	
	\only<1>{
	\begin{tikzpicture}
		\tkzTabInit
		 %[lgt=3,espcl=1.5]
	       		{$x$ / 1 , Variation de $f(x)$ / 2, Signe de $f'(x)$ / 2}
	       		{-3,,,2}
	\end{tikzpicture}
	}
	
	\only<2>{
	\begin{tikzpicture}
		\tkzTabInit
		 %[lgt=3,espcl=1.5]
	       		{$x$ / 1 , Variation de $f(x)$ / 2, Signe de $f'(x)$ / 2}
	       		{-3,{-1,55},,2}
	\end{tikzpicture}
	}
	
	\only<3>{
	\begin{tikzpicture}
		\tkzTabInit
		 %[lgt=3,espcl=1.5]
	       		{$x$ / 1 , Variation de $f(x)$ / 2, Signe de $f'(x)$ / 2}
	       		{-3,{-1,55},{0,21},2}
	\end{tikzpicture}
	}
	
	\only<4>{
	\begin{tikzpicture}
		\tkzTabInit
		 %[lgt=3,espcl=1.5]
	       		{$x$ / 1 , Variation de $f(x)$ / 2, Signe de $f'(x)$ / 2}
	       		{-3,{-1,55},{0,21},2}
		
		\tkzTabVar
		{-/, +/, -/, +/}
	\end{tikzpicture}
	}
	
	\only<5>{
	\begin{tikzpicture}
		\tkzTabInit
		 %[lgt=3,espcl=1.5]
	       		{$x$ / 1 , Variation de $f(x)$ / 2, Signe de $f'(x)$ / 2}
	       		{-3,{-1,55},{0,21},2}
		
		\tkzTabVar
		{-/, +/, -/, +/}
		
		\tkzTabLine
		{,+,z,-,z,+,}
	\end{tikzpicture}
	}
	
	\end{center}

\end{frame}

\begin{frame}

		\begin{center}
			Un extremum local de $f$ survient lorsque $f'$ change de \pause \textbf{signe}. \pause
		\end{center}
		
		\begin{center}
			Si un extremum local de $f$ survient en $x$, on a nécessairement \pause $\mathbf{f'(x) = 0}$.
		\end{center}

\end{frame}

\end{document}